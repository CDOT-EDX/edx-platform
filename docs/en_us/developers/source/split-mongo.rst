############################
Split Mongo Modulestore
############################

*Split Mongo* is the term used for the new edX modulestore. Split Mongo is
built on mongoDB. For information about mongoDB, see the `mongoDB website`_. 

The "split" in Split Mongo refers to how a course is split into branches. In
the current implementation, the edX Platform uses a published branch and a
draft branch for each course.

See:

* `Split Mongo Data Model`_
* `Split Mongo Capabilities`_
* `Split Mongo Course Keys`_
* `Split Mongo and Other edX Modulestores`_


.. _mongoDB website: http://www.mongodb.org

************************
Split Mongo Data Model
************************

In the Split Mongo data model, edX courses are split into three collections
(right term?):

* `Course Index`_
* `Course Structures`_
* `Course Definitions`_

GRAPHIC TBP

=============
Course Index
=============

The course index is a dictionary that stores course IDs. Each course ID points
to a course structure.

SHOW A DATABASE VIEW?

For each course, there is an entry for both the published and draft versions of
the course. The published and draft versions of the course point to different
structures.

As currently implemented in the edX Platform, students using the LMS see and
interact with the published version of the course. 

Course staff using edX Studio make changes to the draft version of the course.
When course staff publish units, they make that version of the course the
published version. When course staff begins another set of changes, the draft
branch is updated.

==========================
Course Structures
==========================

Course structures define, or outline, the content of a course.

A course structure is made up of blocks in a `directed acyclic graph`_. Blocks
are objects in a course, such as the course itself, sections, subsections, and
units.  A block can contain other blocks; for example, a section contains one
or more subsections. Each block has a unique ID that is generated by the edX
Platform.

SHOW A DATABASE VIEW?

Each block in the course structure points to a :ref:`definition <Course
Definitions>`. Different blocks, in different structures, can point to the same
definition.

Course structures, and each block within a structure, are versioned. That is,
when a course author changes a course [DETAILS ON BOUNDARIES NEEDED?], a new
course structure is saved; the previous course structure remains in the
database and is not modified. A new version of the block(s) the course author
changed is also saved.

.. _directed acyclic graph: http://en.wikipedia.org/wiki/Directed_acyclic_graph

.. _Course Definitions:

==========================
Course Definitions
==========================

Course definitions contain the content of each block. For some blocks, such as
sections and subsections, the definition consists of the blocks display name.
For components, such as HTML or exercises, the definition contains the content
of the object. A definition can be referenced by multiple blocks.

SHOW A DATABASE VIEW?

Course definitions are versioned. That is, when a course author changes
content, a new course definition for that object is saved; the previous
definition remains in the database and is not modified.



************************
Split Mongo Capabilities
************************

Abilities enabled for applications

Versioning

Drafts/Publishing

Reuse


************************
Split Mongo Course Keys
************************


Locators - Course, Block, Definition



***************************************
Split Mongo and Other edX Modulestores
***************************************


1 - Course is tree of flat XML files

2 - Course is a tree of XBlocks. Each XBlock is a document in Mongo.

3 - Tree of XBlocks.  1 Document for entire course. Pointers to shared XBlocks.


==========================
Configuring Modulestores 
==========================

TBP