############################
Split Mongo Modulestore
############################

See:

* `Overview`_
* `Split Mongo Data Model`_
* `Split Mongo Capabilities`_
* `Split Mongo Course Keys`_
* `Split Mongo and Other edX Modulestores`_

************************
Overview
************************

*Split Mongo* is the term used for the new edX modulestore. Split Mongo is
built on mongoDB. For information about mongoDB, see the `mongoDB website`_. 

The "split" in Split Mongo refers to how a course is split into three types of
information:

* The course identity, referred to as the `Course Index`_.
* The `course structure <Course Structures>`_.
* The course content, referred to as `XBlock Definitions`_.

This separation of identity, structure, and content enables course authors to
use more advanced capabilities when developing and managing courses.


.. _mongoDB website: http://www.mongodb.org

************************
Split Mongo Data Model
************************

In the Split Mongo data model, edX courses are split into three collections
(right term?):

* `Course Index`_
* `Course Structures`_
* `XBlock Definitions`_

GRAPHIC TBP

=============
Course Index
=============

The course index is a dictionary that stores course IDs. Each course ID points
to a course structure.

SHOW A DATABASE VIEW?

The course index supports multiple branches of a course.  The index can store
multiple entries for a course ID, with each entry pointing to a different
course structure that corresponds to a different branch.

As currently implemented in the edX Platform, for each course, there is an
branch for both the published and draft versions of the course. The published
and draft branches of the course point to different structures.

*  Students using the LMS see and interact with the published version of the
   course.

*  Course staff using edX Studio make changes to the draft version of the
   course. When course staff publish units, they make that version of the
   course the published version. When course staff begins another set of
   changes, the draft branch is updated.

==========================
Course Structures
==========================

The course structures defines, or outlines, the content of a course.

A course structure is made up of blocks in a tree data structure. Blocks
are objects in a course, such as the course itself, sections, subsections, and
units.  A block can contain other blocks; for example, a section contains one
or more subsections. Each block has a unique ID that is generated by the edX
Platform.

SHOW A DATABASE VIEW?

Each block in the course structure points to a :ref:`definition <XBlock
Definitions>`. Different blocks, in different structures, can point to the same
definition.

Course structures, and each block within a structure, are versioned. That is,
when a course author changes a course [DETAILS ON BOUNDARIES NEEDED?], a new
course structure is saved; the previous course structure remains in the
database and is not modified. A new version of the block(s) the course author
changed is also saved.


.. _XBlock Definitions:

==========================
XBlock Definitions
==========================

Course definitions contain the content of each block. For some blocks, such as
sections and subsections, the definition consists of the blocks display name.
For components, such as HTML or exercises, the definition contains the content
of the object. A definition can be referenced by multiple blocks.

SHOW A DATABASE VIEW?

Course definitions are versioned. That is, when a course author changes
content, a new course definition for that object is saved; the previous
definition remains in the database and is not modified.



************************
Split Mongo Capabilities
************************

Abilities enabled for applications

Versioning

Drafts/Publishing

Reuse


************************
Split Mongo Course Keys
************************


Locators - Course, Block, Definition



***************************************
Split Mongo and Other edX Modulestores
***************************************


1 - Course is tree of flat XML files

2 - Course is a tree of XBlocks. Each XBlock is a document in Mongo.

3 - Tree of XBlocks.  1 Document for entire course. Pointers to shared XBlocks.


==========================
Configuring Modulestores 
==========================

TBP